var Woostify_Sites=function(u){var r,l={install_child:function(e){(new t).init(e)},activate_license:function(e){(new n).init(e)},install_plugins:function(e){(new i).init(e)},install_content:function(e){(new o).init(e)}};function e(){var n=u(".merlin__body"),e=(u(".merlin__body--loading"),u(".merlin__body--exiting"),u("#merlin__drawer-trigger")),i="merlin__drawer--open",t=u(".js-select-filter"),o=u(".js-select-demo");setTimeout(function(){n.addClass("loaded")},100),e.on("click",function(){n.toggleClass(i)}),u(".merlin__button--proceed:not(.merlin__button--closer)").click(function(e){e.preventDefault();var t=this.getAttribute("href");n.addClass("exiting"),setTimeout(function(){window.location=t},400)}),u(".merlin__button--closer").on("click",function(e){n.removeClass(i),e.preventDefault();var t=this.getAttribute("href");setTimeout(function(){n.addClass("exiting")},600),setTimeout(function(){window.location=t},1100)}),u(".button-next").on("click",function(e){if(e.preventDefault(),!f("demo")||"undefined"==f("demo"))return alert("You have to select a demo before start importing."),void console.log(f("demo"));if(!function(e){var t=jQuery(e);if("yes"==t.data("done-loading"))return!1;t.is("input")||t.is("button");-1<r&&t.addClass("merlin__button--loading");return{done:function(){t.attr("disabled",!1)}}}(this))return!1;e=u(this).data("callback");return!e||void 0===l[e]||(l[e](this),!1)});var s=1,a=u(".btn-merlin--loadmore");a.on("click",function(e){var t=u(".merlin__other-page-builder").find(".active").attr("data-group"),n=u(".merlin__categories").find(".active").attr("data-group"),t={action:"woostify_sites_load_more_demo",_ajax_nonce:woostify_sites_params.wpnonce,page:s,category:n,page_builder:t};u.ajax({url:woostify_sites_params.ajaxurl,data:t,type:"POST",beforeSend:function(e){a.addClass("loading")},success:function(e){a.removeClass("loading"),console.log(e),e?(s++,u(".merlin__demos").append(e.data),s>=woostify_sites_params.total_page&&(a.css({display:"none"}),a.attr("disabled","disabled"),s=1)):(a.css({display:"none"}),a.attr("disabled","disabled"),s=1)},error:function(e){alert("Opps!, Something went wrong, please try again later.")}})}),t.on("click",function(e){e.preventDefault(),document.cookie="demo=undefined",console.log(f("demo")),s=1,u(this).parents(".filter-links").find(".active").removeClass("active"),u(this).addClass("active");var t=u(".merlin__other-page-builder").find(".active").attr("data-group"),e=u(".merlin__categories").find(".active").attr("data-group"),e={action:"woostify_site_filter_demo",_ajax_nonce:woostify_sites_params.wpnonce,page_builder:t,category:e};u.ajax({url:woostify_sites_params.ajaxurl,data:e,type:"POST",beforeSend:function(e){u(".merlin__demos").html(""),u(".merlin__demos").addClass("loading")},success:function(e){u(".merlin__button--next").css({display:"none"});var t=parseInt(f("total_page"));u(".merlin__demos").removeClass("loading"),e?(u(".merlin__demos").html(e.data),s<t?(a.css({display:"flex"}),a.removeAttr("disabled")):(a.css({display:"none"}),a.attr("disabled","disabled"))):(a.css({display:"none"}),a.attr("disabled","disabled"))},error:function(e){alert("Opps!, Something went wrong, please try again later.")}})}),u(".merlin__demos ").on("click",".js-select-demo",function(){r=u(this).data("content"),o.removeClass("merlin__demo-button--primary"),console.log(r),document.cookie="demo="+r;var t=u(this),e=u(this).children(":selected");e.data("img-src"),e.data("notice"),e.data("preview-url");console.log(e),u.post(woostify_sites_params.ajaxurl,{action:"woostify_sites_update_selected_import_data_info",_ajax_nonce:woostify_sites_params.wpnonce,selected_index:r},function(e){"success"!=e.data?alert(e.data):(u(".js-merlin-drawer-import-content").html(e.data),t.addClass("merlin__demo-button--primary"),u('[data-callback="install_content"]').css({display:"block"}),u(".js-select").css({display:"block"}))}).fail(function(){alert(woostify_sites_params.texts.something_went_wrong)})})}function t(){var t,n=u(".merlin__body"),i=u("#child-theme-text");function o(e){void 0!==e.done?(setTimeout(function(){i.addClass("lead")},0),setTimeout(function(){i.addClass("success"),i.html(e.message)},600),t()):(i.addClass("lead error"),i.html(e.error))}return{init:function(e){t=function(){setTimeout(function(){u(".merlin__body").addClass("js--finished")},1500),n.removeClass(drawer_opened),setTimeout(function(){u(".merlin__body").addClass("exiting")},3500),setTimeout(function(){window.location.href=e.href},4e3)},jQuery.post(woostify_sites_params.ajaxurl,{action:"woostify_sites_child_theme",wpnonce:woostify_sites_params.wpnonce},o).fail(o)}}}function n(){var t,n=u(".merlin__body"),i=u(".merlin__content--license-key"),o=u("#license-text");function s(e){void 0!==e.success&&e.success?(o.siblings(".error-message").remove(),setTimeout(function(){o.addClass("lead")},0),setTimeout(function(){o.addClass("success"),o.html(e.message)},600),t()):(u(".js-merlin-license-activate-button").removeClass("merlin__button--loading").data("done-loading","no"),o.siblings(".error-message").remove(),i.addClass("has-error"),o.html(e.message),o.siblings(".error-message").addClass("lead error"))}return{init:function(e){t=function(){setTimeout(function(){u(".merlin__body").addClass("js--finished")},1500),n.removeClass(drawer_opened),setTimeout(function(){u(".merlin__body").addClass("exiting")},3500),setTimeout(function(){window.location.href=e.href},4e3)},i.removeClass("has-error"),jQuery.post(woostify_sites_params.ajaxurl,{action:"woostify_sites_activate_license",wpnonce:woostify_sites_params.wpnonce,license_key:u(".js-license-key").val()},s).fail(s)}}}function i(){var t,n,i=u(".merlin__body"),o=0,s="",a="";function r(e){var t=n.find("label");"object"==typeof e&&void 0!==e.message?(t.removeClass("installing success error").addClass(e.message.toLowerCase()),(void 0===e.done||!e.done)&&void 0!==e.url?e.hash==a?(t.removeClass("installing success").addClass("error"),d()):(a=e.hash,jQuery.post(e.url,e,r).fail(r)):d()):l()}function l(){s&&(n.find("input:checkbox").is(":checked")?jQuery.post(woostify_sites_params.ajaxurl,{action:"woostify_sites_plugins",wpnonce:woostify_sites_params.wpnonce,slug:s},r).fail(r):(n.addClass("skipping"),setTimeout(d,300)))}function d(){n&&(n.data("done_item")||(o++,n.data("done_item",1)),n.find(".spinner").css("visibility","hidden"));var e=u(".merlin__drawer--install-plugins li");e.each(function(){var e=u(this);return!!e.data("done_item")||(s=e.data("slug"),n=e,l(),!1)}),o>=e.length&&t()}return{init:function(e){u(".merlin__drawer--install-plugins").addClass("installing"),u(".merlin__drawer--install-plugins").find("input").prop("disabled",!0),t=function(){setTimeout(function(){u(".merlin__body").addClass("js--finished")},1e3),i.removeClass("merlin__drawer--open"),setTimeout(function(){u(".merlin__body").addClass("exiting")},3e3),setTimeout(function(){window.location.href=e.href},3500)},d()}}}function o(){var n,i,o,t=u(".merlin__body"),s=0,a="",r="",l=1,d=0;function c(e){var t=i.find("label");"object"==typeof e&&void 0!==e.message?(t.addClass(e.message.toLowerCase()),void 0!==e.num_of_imported_posts&&0<d&&(l="all"===e.num_of_imported_posts?d:e.num_of_imported_posts,m()),void 0!==e.url?e.hash===r?(t.addClass("status--failed"),_()):(r=e.hash,void 0===e.selected_index&&(e.selected_index=f("demo")),jQuery.post(e.url,e,c).fail(c)):(e.done,_())):(console.log(e),t.addClass("status--error"),_())}function _(){var e=!1;i&&(console.log(222),i.data("done_item")||(s++,i.data("done_item",1)),i.find(".spinner").css("visibility","hidden"));var t=u(".merlin__drawer--import-content__list-item");u(".merlin__drawer--import-content__list-item input:checked");t.each(function(){""==a||e?(a=u(this).data("content"),i=u(this),a&&(i.find("input:checkbox").is(":checked")?jQuery.post(woostify_sites_params.ajaxurl,{action:"woostify_sites_content",wpnonce:woostify_sites_params.wpnonce,content:a,selected_index:f("demo")},c).fail(c):(i.addClass("skipping"),setTimeout(_,300))),e=!1):u(this).data("content")==a&&(e=!0)}),s>=t.length&&n()}function m(){u(".js-merlin-progress-bar").css("width",l/d*100+"%");var e,t,n,e=(e=l/d*100,t=0,n=99,Math.min(n,Math.max(t,e)));u(".js-merlin-progress-bar-percentage").html(Math.round(e)+"%"),1==l/d&&clearInterval(o)}return{init:function(e){if(!f("demo")||"undefined"==f("demo"))return alert("You have to select a demo before start importing."),void console.log(f("demo"));u(".merlin__drawer--import-content").addClass("installing"),u(".merlin__drawer--import-content").find("input").prop("disabled",!0),u(e).find(".merlin__button--loading__text").css("color","transparent"),u(e).find(".js-merlin-progress-bar-percentage").css({display:"inline-block",color:"#46b450"}),n=function(){u.post(woostify_sites_params.ajaxurl,{action:"woostify_sites_import_finished",wpnonce:woostify_sites_params.wpnonce,selected_index:f("demo")}),setTimeout(function(){u(".js-merlin-progress-bar-percentage").html("100%")},100),setTimeout(function(){t.removeClass("merlin__drawer--open")},500),setTimeout(function(){u(".merlin__body").addClass("js--finished")},1500),setTimeout(function(){u(".merlin__body").addClass("exiting")},3400),setTimeout(function(){window.location.href=e.href},4e3)},u(".merlin__drawer--import-content__list-item .checkbox-content").is(":checked")&&jQuery.post(woostify_sites_params.ajaxurl,{action:"woostify_sites_get_total_content_import_items",wpnonce:woostify_sites_params.wpnonce,selected_index:f("demo")},function(e){d=e.data,console.log(e),0<d&&(m(),o=setInterval(function(){l+=d/500,m()},1e3))}),_()}}}function f(e){for(var t=e+"=",n=decodeURIComponent(document.cookie).split(";"),i=0;i<n.length;i++){for(var o=n[i];" "==o.charAt(0);)o=o.substring(1);if(0==o.indexOf(t))return o.substring(t.length,o.length)}return""}return{init:function(){u(e)},callback:function(e){console.log(e),console.log(this)}}}(jQuery);Woostify_Sites.init();